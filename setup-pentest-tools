#!/bin/sh

code_analysis_pkgs="netsink pychecker pyflakes pylint rats rpmlint trace"
forensics_pkgs="htop ncdu testdisk wipe"
reconnaissance_pkgs="nmap tshark tcpdump"
voip_analysis_pkgs="enumiax"
live_host_identification_pkgs="hping3"

menu_code_analysis () {
	code_analysis_pkgs=$(dialog --stdout                    	        \
        --title 'Code Analysis'		               				\
        --checklist 'Select the packages to install'    		        \
        0 0 0                                    			        \
	netsink      'A Network Sinkhole for Isolated Malware Analysis'      on \
   	pychecker    'A analyser for python source code'                     on \
   	pyflakes     'A passive checker of Python programs'                  on \
   	pylint       'Analyzes Python code for bugs/signs of poor quality'   on \
   	rats         'Find security related programming errors'              on \
   	rpmlint      'A tool for checking common errors in RPM packages'     on \
   	strace       'A diagnositic, instructional, and debugging tool'      on
	)
}

menu_forensics () {
        forensics_pkgs=$(dialog --stdout	                                \
        --title 'Forensics'		                                        \
        --checklist 'Select the packages to install'                            \
        0 0 0                                                                   \
	htop         'An interactive process viewer for Linux'               on \
   	ncdu         'A curses-based version of the well-known "du"'         on \
   	testdisk     'A powerful free data recovery software'		     on \
   	wipe         'Tool for securely erasing files from magnetic media'   on
	)
}

menu_reconnaissance () {
        reconnaissance_pkgs=$(dialog --stdout                                    \
        --title 'Reconnaissance'                                                 \
        --checklist 'Select the packages to install' 	                         \
        0 0 0                                                                    \
	nmap         'Reconnaissance - Network Mapper'			      on \
	tshark       'Reconnaissance - Dump and analyze network traffic'      on \
  	tcpdump      'Reconnaissance - Dump traffic on a network '            on \
	)
}

menu_voip_analysis () {
        voip_analysis_pkgs=$(dialog --stdout                                     \
        --title 'VoIP Analysis'                                                  \
        --checklist 'Select the packages to install'                             \
        0 0 0                                                                    \
	enumiax      'Asterisk Exchange v2 username brute-force enumerator.'  on \
        )
}

menu_live_host_identification() {
        live_host_identification_pkgs=$(dialog --stdout                           \
        --title 'Live Host Identification'                                        \
        --checklist 'Select the packages to install'                              \
        0 0 0                                                                     \
	hping3       'Send arbitrary TCP/IP packets to network hosts'  	       on \
        )
}

while : ; do
   resposta=$( dialog --stdout				\
	--title 'setup-pentest-tools' 			\
	--extra-button					\
	--extra-label	"Install"			\
	--menu 'Select menu install'			\
	0 0 0 						\
	CodeAnalysis	 'd '				\				
	Forensics	 ' '				\
	Reconnaissance ' '				\
	VoIPAnalysis  ' '				\
	LiveHostIdentification ' '
   )

   case "$?" in
      1) break ;;
      3) echo "vamos instalar" && break ;;
   esac

   case "$resposta" in
      'Code Analysis') 
	menu_code_analysis
	;;
      'Forensics') 
	menu_forensics
	;;
      'Reconnaissance')
        menu_reconnaissance
	;;
      'VoIP Analysis')
        menu_voip_analysis
	;;
      'Live Host Identification')
        menu_live_host_identification
	;;
      *) echo $resposta && break ;;
   esac

done
